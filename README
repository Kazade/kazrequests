Ripped out of kazbase, needs fixing up a lot!
